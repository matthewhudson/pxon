<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PXON â€” Pixel Object Notation</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-deep: #0a0a2e;
        --window-bg: #1a1a4e;
        --window-border-light: #8888ff;
        --window-border-dark: #1a1a3e;
        --text-primary: #e8e8e8;
        --text-gold: #ffd700;
        --text-green: #68ff68;
        --code-bg: #0d0d2d;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      ::selection {
        background: var(--text-gold);
        color: #000;
      }

      body {
        font-family: 'Press Start 2P', cursive;
        background-color: var(--bg-deep);
        color: var(--text-primary);
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
        line-height: 2;
        font-size: 12px;
        position: relative;
      }

      body::after {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        background: repeating-linear-gradient(
          0deg,
          rgba(0, 0, 0, 0.15) 0px,
          rgba(0, 0, 0, 0.15) 1px,
          transparent 1px,
          transparent 2px
        );
      }

      /* RPG Dialog Box */
      .rpg-box {
        background: var(--window-bg);
        border: 4px solid var(--window-border-light);
        outline: 4px solid var(--window-border-dark);
        box-shadow:
          inset 0 0 0 2px var(--window-border-dark),
          0 0 0 2px #000;
        padding: 24px;
        margin-bottom: 24px;
      }

      .rpg-box h2 {
        color: var(--text-gold);
        text-transform: uppercase;
        letter-spacing: 3px;
        font-size: 14px;
        margin-bottom: 16px;
      }

      .rpg-box p {
        color: var(--text-primary);
        line-height: 2;
        font-size: 11px;
      }

      .rpg-link {
        color: var(--text-gold);
        text-decoration: none;
        display: inline-block;
        transition: text-shadow 0.2s;
      }

      .rpg-link:hover {
        text-shadow: 0 0 8px var(--text-gold);
      }

      .rpg-link::before {
        content: '\25B6  ';
      }

      .rpg-btn {
        font-family: 'Press Start 2P', cursive;
        color: var(--text-gold);
        background: var(--bg-deep);
        border: 3px solid var(--window-border-light);
        padding: 12px 20px;
        cursor: pointer;
        font-size: 12px;
        text-shadow: 2px 2px 0 #000;
        transition: text-shadow 0.2s, box-shadow 0.2s;
      }

      .rpg-btn:hover {
        text-shadow: 0 0 10px var(--text-gold), 2px 2px 0 #000;
        box-shadow: 0 0 12px rgba(255, 215, 0, 0.3);
      }

      /* Hero */
      .hero {
        text-align: center;
        padding: 60px 0 30px;
      }

      .hero h1 {
        font-size: 2rem;
        color: var(--text-gold);
        text-shadow:
          0 0 10px rgba(255, 215, 0, 0.5),
          3px 3px 0 #000;
        margin-bottom: 12px;
      }

      .tagline {
        font-size: 12px;
        color: #aaaacc;
        letter-spacing: 2px;
      }

      /* Info box links */
      .info-links {
        margin-top: 16px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      /* Examples grid */
      .examples-grid {
        display: flex;
        gap: 24px;
        flex-wrap: wrap;
      }

      .examples-grid .rpg-box {
        flex: 1 1 380px;
        min-width: 300px;
      }

      .pixel-grid {
        border: 2px solid var(--window-border-light);
        box-sizing: content-box;
        display: inline-block;
        margin: 16px auto;
        background: transparent;
      }

      .pixel-grid-wrap {
        text-align: center;
      }

      .pixel {
        width: 16px;
        height: 16px;
        float: left;
        box-sizing: border-box;
      }

      /* Details / JSON toggle */
      details {
        margin-top: 16px;
      }

      details summary {
        font-family: 'Press Start 2P', cursive;
        color: var(--text-gold);
        font-size: 10px;
        cursor: pointer;
        padding: 8px 0;
        outline: none;
        list-style: none;
        transition: text-shadow 0.2s;
      }

      details summary::-webkit-details-marker {
        display: none;
      }

      details summary::before {
        content: '\25B6  ';
      }

      details[open] summary::before {
        content: '\25BC  ';
      }

      details summary:hover {
        text-shadow: 0 0 8px var(--text-gold);
      }

      pre {
        background: var(--code-bg);
        color: var(--text-green);
        font-family: monospace;
        font-size: 12px;
        padding: 16px;
        overflow-x: auto;
        line-height: 1.5;
        border: 2px solid var(--window-border-dark);
        margin-top: 8px;
      }

      /* Custom input section */
      textarea#custom-input {
        width: 100%;
        font-family: monospace;
        font-size: 13px;
        padding: 12px;
        background: var(--code-bg);
        color: var(--text-green);
        border: 3px solid var(--window-border-light);
        resize: vertical;
        margin-bottom: 12px;
      }

      textarea#custom-input::placeholder {
        color: #5566aa;
      }

      textarea#custom-input:focus {
        outline: none;
        box-shadow: 0 0 8px rgba(136, 136, 255, 0.4);
      }

      .message-area {
        margin-top: 10px;
        padding: 12px 16px;
        font-family: 'Press Start 2P', cursive;
        font-size: 10px;
        line-height: 1.8;
        display: none;
      }

      .message-area.success {
        background: rgba(104, 255, 104, 0.1);
        color: var(--text-green);
        border: 2px solid var(--text-green);
      }

      .message-area.error {
        background: rgba(255, 100, 100, 0.1);
        color: #ff6666;
        border: 2px solid #ff6666;
      }

      .btn-wrap {
        margin-bottom: 12px;
      }

      /* Responsive */
      @media (max-width: 700px) {
        .hero h1 {
          font-size: 1.2rem;
        }

        .rpg-box {
          padding: 16px;
        }

        .examples-grid {
          flex-direction: column;
        }

        .examples-grid .rpg-box {
          min-width: 0;
        }

        body {
          padding: 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="hero">
      <h1>&#9733; P X O N &#9733;</h1>
      <p class="tagline">Pixel Object Notation</p>
    </div>

    <div class="rpg-box">
      <h2>Quest Log</h2>
      <p>
        PXON (Pixel Object Notation) is a JSON-based format for describing pixel art.
        It provides a structured way to represent pixel-based images with metadata,
        import/export, and manipulation tools.
      </p>
      <div class="info-links">
        <a class="rpg-link" href="https://github.com/matthewhudson/pxon" target="_blank">View on GitHub</a>
        <a class="rpg-link" href="https://jennmoney.biz/pxon" target="_blank">PXON Specification</a>
      </div>
    </div>

    <div class="examples-grid">
      <div class="rpg-box">
        <h2>Mario</h2>
        <div class="pixel-grid-wrap">
          <div id="mario-grid" class="pixel-grid"></div>
        </div>
        <details>
          <summary>View PXON JSON</summary>
          <pre id="mario-json"></pre>
        </details>
      </div>

      <div class="rpg-box">
        <h2>1-Up Mushroom</h2>
        <div class="pixel-grid-wrap">
          <div id="mushroom-grid" class="pixel-grid"></div>
        </div>
        <details>
          <summary>View PXON JSON</summary>
          <pre id="mushroom-json"></pre>
        </details>
      </div>
    </div>

    <div class="rpg-box">
      <h2>Custom Input</h2>
      <textarea
        id="custom-input"
        rows="12"
        placeholder="Paste your PXON JSON here..."
      ></textarea>
      <div class="btn-wrap">
        <button class="rpg-btn" onclick="renderCustom()">VISUALIZE</button>
      </div>
      <div id="custom-message-area" class="message-area"></div>
      <div class="pixel-grid-wrap">
        <div id="custom-grid" class="pixel-grid"></div>
      </div>
    </div>

    <script type="module">
      const examples = {
        mario: {
          pxon: {
            version: '1.0',
            title: 'Mario',
            description: 'Classic standing Mario sprite',
            width: 16,
            height: 16,
            colors: {
              R: '#E52521',
              B: '#0038A8',
              S: '#FFB580',
              H: '#6B3304',
              Y: '#FBD000',
            },
            pixels: [
              // Row 0: top of cap
              { x: 5, y: 0, color: 'R' },
              { x: 6, y: 0, color: 'R' },
              { x: 7, y: 0, color: 'R' },
              { x: 8, y: 0, color: 'R' },
              { x: 9, y: 0, color: 'R' },

              // Row 1: cap widens
              { x: 4, y: 1, color: 'R' },
              { x: 5, y: 1, color: 'R' },
              { x: 6, y: 1, color: 'R' },
              { x: 7, y: 1, color: 'R' },
              { x: 8, y: 1, color: 'R' },
              { x: 9, y: 1, color: 'R' },
              { x: 10, y: 1, color: 'R' },
              { x: 11, y: 1, color: 'R' },
              { x: 12, y: 1, color: 'R' },

              // Row 2: hair line + face start
              { x: 4, y: 2, color: 'H' },
              { x: 5, y: 2, color: 'H' },
              { x: 6, y: 2, color: 'H' },
              { x: 7, y: 2, color: 'S' },
              { x: 8, y: 2, color: 'S' },
              { x: 9, y: 2, color: 'S' },
              { x: 10, y: 2, color: 'H' },
              { x: 11, y: 2, color: 'S' },

              // Row 3: face with eyes
              { x: 3, y: 3, color: 'H' },
              { x: 4, y: 3, color: 'S' },
              { x: 5, y: 3, color: 'H' },
              { x: 6, y: 3, color: 'S' },
              { x: 7, y: 3, color: 'S' },
              { x: 8, y: 3, color: 'S' },
              { x: 9, y: 3, color: 'H' },
              { x: 10, y: 3, color: 'S' },
              { x: 11, y: 3, color: 'S' },
              { x: 12, y: 3, color: 'S' },

              // Row 4: face with nose/mustache
              { x: 3, y: 4, color: 'H' },
              { x: 4, y: 4, color: 'S' },
              { x: 5, y: 4, color: 'H' },
              { x: 6, y: 4, color: 'H' },
              { x: 7, y: 4, color: 'S' },
              { x: 8, y: 4, color: 'S' },
              { x: 9, y: 4, color: 'S' },
              { x: 10, y: 4, color: 'H' },
              { x: 11, y: 4, color: 'S' },
              { x: 12, y: 4, color: 'S' },
              { x: 13, y: 4, color: 'S' },

              // Row 5: chin/face bottom
              { x: 3, y: 5, color: 'H' },
              { x: 4, y: 5, color: 'H' },
              { x: 5, y: 5, color: 'S' },
              { x: 6, y: 5, color: 'S' },
              { x: 7, y: 5, color: 'S' },
              { x: 8, y: 5, color: 'S' },
              { x: 9, y: 5, color: 'H' },
              { x: 10, y: 5, color: 'H' },
              { x: 11, y: 5, color: 'H' },
              { x: 12, y: 5, color: 'H' },

              // Row 6: shirt top
              { x: 5, y: 6, color: 'R' },
              { x: 6, y: 6, color: 'R' },
              { x: 7, y: 6, color: 'B' },
              { x: 8, y: 6, color: 'R' },
              { x: 9, y: 6, color: 'R' },
              { x: 10, y: 6, color: 'B' },

              // Row 7: arms + shirt
              { x: 4, y: 7, color: 'R' },
              { x: 5, y: 7, color: 'R' },
              { x: 6, y: 7, color: 'R' },
              { x: 7, y: 7, color: 'B' },
              { x: 8, y: 7, color: 'R' },
              { x: 9, y: 7, color: 'R' },
              { x: 10, y: 7, color: 'B' },
              { x: 11, y: 7, color: 'R' },
              { x: 12, y: 7, color: 'R' },
              { x: 13, y: 7, color: 'R' },

              // Row 8: arms + overalls
              { x: 3, y: 8, color: 'S' },
              { x: 4, y: 8, color: 'R' },
              { x: 5, y: 8, color: 'R' },
              { x: 6, y: 8, color: 'R' },
              { x: 7, y: 8, color: 'B' },
              { x: 8, y: 8, color: 'B' },
              { x: 9, y: 8, color: 'B' },
              { x: 10, y: 8, color: 'B' },
              { x: 11, y: 8, color: 'R' },
              { x: 12, y: 8, color: 'R' },
              { x: 13, y: 8, color: 'R' },
              { x: 14, y: 8, color: 'S' },

              // Row 9: hands + overalls with buttons
              { x: 2, y: 9, color: 'S' },
              { x: 3, y: 9, color: 'S' },
              { x: 4, y: 9, color: 'R' },
              { x: 5, y: 9, color: 'R' },
              { x: 6, y: 9, color: 'B' },
              { x: 7, y: 9, color: 'Y' },
              { x: 8, y: 9, color: 'B' },
              { x: 9, y: 9, color: 'B' },
              { x: 10, y: 9, color: 'Y' },
              { x: 11, y: 9, color: 'B' },
              { x: 12, y: 9, color: 'R' },
              { x: 13, y: 9, color: 'S' },
              { x: 14, y: 9, color: 'S' },

              // Row 10: overalls mid
              { x: 2, y: 10, color: 'S' },
              { x: 3, y: 10, color: 'S' },
              { x: 4, y: 10, color: 'S' },
              { x: 5, y: 10, color: 'B' },
              { x: 6, y: 10, color: 'B' },
              { x: 7, y: 10, color: 'B' },
              { x: 8, y: 10, color: 'B' },
              { x: 9, y: 10, color: 'B' },
              { x: 10, y: 10, color: 'B' },
              { x: 11, y: 10, color: 'B' },
              { x: 12, y: 10, color: 'S' },
              { x: 13, y: 10, color: 'S' },

              // Row 11: overalls bottom
              { x: 5, y: 11, color: 'B' },
              { x: 6, y: 11, color: 'B' },
              { x: 7, y: 11, color: 'B' },
              { x: 8, y: 11, color: 'B' },
              { x: 9, y: 11, color: 'B' },
              { x: 10, y: 11, color: 'B' },
              { x: 11, y: 11, color: 'B' },

              // Row 12: legs split
              { x: 4, y: 12, color: 'H' },
              { x: 5, y: 12, color: 'H' },
              { x: 6, y: 12, color: 'H' },
              { x: 10, y: 12, color: 'H' },
              { x: 11, y: 12, color: 'H' },
              { x: 12, y: 12, color: 'H' },

              // Row 13: shoes
              { x: 3, y: 13, color: 'H' },
              { x: 4, y: 13, color: 'H' },
              { x: 5, y: 13, color: 'H' },
              { x: 6, y: 13, color: 'H' },
              { x: 10, y: 13, color: 'H' },
              { x: 11, y: 13, color: 'H' },
              { x: 12, y: 13, color: 'H' },
              { x: 13, y: 13, color: 'H' },
            ],
          },
        },
        mushroom: {
          pxon: {
            version: '1.0',
            title: '1-Up Mushroom',
            description: 'Classic 1-Up mushroom from Super Mario Bros',
            width: 16,
            height: 16,
            colors: {
              G: '#00A800',
              W: '#FFFFFF',
              T: '#FFCC99',
              K: '#000000',
              E: '#FFE0BD',
            },
            pixels: [
              // Row 0: top outline of dome
              { x: 5, y: 0, color: 'K' },
              { x: 6, y: 0, color: 'K' },
              { x: 7, y: 0, color: 'K' },
              { x: 8, y: 0, color: 'K' },
              { x: 9, y: 0, color: 'K' },
              { x: 10, y: 0, color: 'K' },

              // Row 1: dome widens
              { x: 3, y: 1, color: 'K' },
              { x: 4, y: 1, color: 'K' },
              { x: 5, y: 1, color: 'W' },
              { x: 6, y: 1, color: 'W' },
              { x: 7, y: 1, color: 'G' },
              { x: 8, y: 1, color: 'G' },
              { x: 9, y: 1, color: 'W' },
              { x: 10, y: 1, color: 'W' },
              { x: 11, y: 1, color: 'K' },
              { x: 12, y: 1, color: 'K' },

              // Row 2
              { x: 2, y: 2, color: 'K' },
              { x: 3, y: 2, color: 'W' },
              { x: 4, y: 2, color: 'W' },
              { x: 5, y: 2, color: 'W' },
              { x: 6, y: 2, color: 'G' },
              { x: 7, y: 2, color: 'G' },
              { x: 8, y: 2, color: 'G' },
              { x: 9, y: 2, color: 'G' },
              { x: 10, y: 2, color: 'W' },
              { x: 11, y: 2, color: 'W' },
              { x: 12, y: 2, color: 'W' },
              { x: 13, y: 2, color: 'K' },

              // Row 3
              { x: 1, y: 3, color: 'K' },
              { x: 2, y: 3, color: 'G' },
              { x: 3, y: 3, color: 'W' },
              { x: 4, y: 3, color: 'W' },
              { x: 5, y: 3, color: 'G' },
              { x: 6, y: 3, color: 'G' },
              { x: 7, y: 3, color: 'G' },
              { x: 8, y: 3, color: 'G' },
              { x: 9, y: 3, color: 'G' },
              { x: 10, y: 3, color: 'G' },
              { x: 11, y: 3, color: 'W' },
              { x: 12, y: 3, color: 'W' },
              { x: 13, y: 3, color: 'G' },
              { x: 14, y: 3, color: 'K' },

              // Row 4
              { x: 1, y: 4, color: 'K' },
              { x: 2, y: 4, color: 'G' },
              { x: 3, y: 4, color: 'G' },
              { x: 4, y: 4, color: 'W' },
              { x: 5, y: 4, color: 'G' },
              { x: 6, y: 4, color: 'G' },
              { x: 7, y: 4, color: 'W' },
              { x: 8, y: 4, color: 'W' },
              { x: 9, y: 4, color: 'G' },
              { x: 10, y: 4, color: 'G' },
              { x: 11, y: 4, color: 'W' },
              { x: 12, y: 4, color: 'G' },
              { x: 13, y: 4, color: 'G' },
              { x: 14, y: 4, color: 'K' },

              // Row 5
              { x: 0, y: 5, color: 'K' },
              { x: 1, y: 5, color: 'G' },
              { x: 2, y: 5, color: 'G' },
              { x: 3, y: 5, color: 'G' },
              { x: 4, y: 5, color: 'W' },
              { x: 5, y: 5, color: 'W' },
              { x: 6, y: 5, color: 'W' },
              { x: 7, y: 5, color: 'W' },
              { x: 8, y: 5, color: 'W' },
              { x: 9, y: 5, color: 'W' },
              { x: 10, y: 5, color: 'W' },
              { x: 11, y: 5, color: 'W' },
              { x: 12, y: 5, color: 'G' },
              { x: 13, y: 5, color: 'G' },
              { x: 14, y: 5, color: 'G' },
              { x: 15, y: 5, color: 'K' },

              // Row 6
              { x: 0, y: 6, color: 'K' },
              { x: 1, y: 6, color: 'G' },
              { x: 2, y: 6, color: 'W' },
              { x: 3, y: 6, color: 'W' },
              { x: 4, y: 6, color: 'W' },
              { x: 5, y: 6, color: 'W' },
              { x: 6, y: 6, color: 'W' },
              { x: 7, y: 6, color: 'W' },
              { x: 8, y: 6, color: 'W' },
              { x: 9, y: 6, color: 'W' },
              { x: 10, y: 6, color: 'W' },
              { x: 11, y: 6, color: 'W' },
              { x: 12, y: 6, color: 'W' },
              { x: 13, y: 6, color: 'W' },
              { x: 14, y: 6, color: 'G' },
              { x: 15, y: 6, color: 'K' },

              // Row 7: bottom of cap
              { x: 0, y: 7, color: 'K' },
              { x: 1, y: 7, color: 'W' },
              { x: 2, y: 7, color: 'W' },
              { x: 3, y: 7, color: 'W' },
              { x: 4, y: 7, color: 'W' },
              { x: 5, y: 7, color: 'W' },
              { x: 6, y: 7, color: 'W' },
              { x: 7, y: 7, color: 'W' },
              { x: 8, y: 7, color: 'W' },
              { x: 9, y: 7, color: 'W' },
              { x: 10, y: 7, color: 'W' },
              { x: 11, y: 7, color: 'W' },
              { x: 12, y: 7, color: 'W' },
              { x: 13, y: 7, color: 'W' },
              { x: 14, y: 7, color: 'W' },
              { x: 15, y: 7, color: 'K' },

              // Row 8: cap bottom outline + face top
              { x: 1, y: 8, color: 'K' },
              { x: 2, y: 8, color: 'K' },
              { x: 3, y: 8, color: 'K' },
              { x: 4, y: 8, color: 'K' },
              { x: 5, y: 8, color: 'K' },
              { x: 6, y: 8, color: 'K' },
              { x: 7, y: 8, color: 'K' },
              { x: 8, y: 8, color: 'K' },
              { x: 9, y: 8, color: 'K' },
              { x: 10, y: 8, color: 'K' },
              { x: 11, y: 8, color: 'K' },
              { x: 12, y: 8, color: 'K' },
              { x: 13, y: 8, color: 'K' },
              { x: 14, y: 8, color: 'K' },

              // Row 9: face/stem top
              { x: 2, y: 9, color: 'K' },
              { x: 3, y: 9, color: 'E' },
              { x: 4, y: 9, color: 'E' },
              { x: 5, y: 9, color: 'E' },
              { x: 6, y: 9, color: 'E' },
              { x: 7, y: 9, color: 'E' },
              { x: 8, y: 9, color: 'E' },
              { x: 9, y: 9, color: 'E' },
              { x: 10, y: 9, color: 'E' },
              { x: 11, y: 9, color: 'E' },
              { x: 12, y: 9, color: 'E' },
              { x: 13, y: 9, color: 'K' },

              // Row 10: face with eyes
              { x: 2, y: 10, color: 'K' },
              { x: 3, y: 10, color: 'E' },
              { x: 4, y: 10, color: 'K' },
              { x: 5, y: 10, color: 'K' },
              { x: 6, y: 10, color: 'E' },
              { x: 7, y: 10, color: 'E' },
              { x: 8, y: 10, color: 'E' },
              { x: 9, y: 10, color: 'E' },
              { x: 10, y: 10, color: 'K' },
              { x: 11, y: 10, color: 'K' },
              { x: 12, y: 10, color: 'E' },
              { x: 13, y: 10, color: 'K' },

              // Row 11: face with eyes
              { x: 3, y: 11, color: 'K' },
              { x: 4, y: 11, color: 'K' },
              { x: 5, y: 11, color: 'K' },
              { x: 6, y: 11, color: 'E' },
              { x: 7, y: 11, color: 'E' },
              { x: 8, y: 11, color: 'E' },
              { x: 9, y: 11, color: 'E' },
              { x: 10, y: 11, color: 'K' },
              { x: 11, y: 11, color: 'K' },
              { x: 12, y: 11, color: 'K' },

              // Row 12: stem
              { x: 3, y: 12, color: 'K' },
              { x: 4, y: 12, color: 'T' },
              { x: 5, y: 12, color: 'T' },
              { x: 6, y: 12, color: 'T' },
              { x: 7, y: 12, color: 'T' },
              { x: 8, y: 12, color: 'T' },
              { x: 9, y: 12, color: 'T' },
              { x: 10, y: 12, color: 'T' },
              { x: 11, y: 12, color: 'T' },
              { x: 12, y: 12, color: 'K' },

              // Row 13: stem
              { x: 4, y: 13, color: 'K' },
              { x: 5, y: 13, color: 'T' },
              { x: 6, y: 13, color: 'T' },
              { x: 7, y: 13, color: 'T' },
              { x: 8, y: 13, color: 'T' },
              { x: 9, y: 13, color: 'T' },
              { x: 10, y: 13, color: 'T' },
              { x: 11, y: 13, color: 'K' },

              // Row 14: stem bottom
              { x: 4, y: 14, color: 'K' },
              { x: 5, y: 14, color: 'T' },
              { x: 6, y: 14, color: 'T' },
              { x: 7, y: 14, color: 'T' },
              { x: 8, y: 14, color: 'T' },
              { x: 9, y: 14, color: 'T' },
              { x: 10, y: 14, color: 'T' },
              { x: 11, y: 14, color: 'K' },

              // Row 15: bottom outline
              { x: 5, y: 15, color: 'K' },
              { x: 6, y: 15, color: 'K' },
              { x: 7, y: 15, color: 'K' },
              { x: 8, y: 15, color: 'K' },
              { x: 9, y: 15, color: 'K' },
              { x: 10, y: 15, color: 'K' },
            ],
          },
        },
      }

      function showMessage(elementId, message, type = 'error') {
        const messageArea = document.getElementById(elementId)
        if (messageArea) {
          messageArea.textContent = message
          messageArea.className = 'message-area ' + type
          messageArea.style.display = 'block'
        }
      }

      function clearMessage(elementId) {
        const messageArea = document.getElementById(elementId)
        if (messageArea) {
          messageArea.textContent = ''
          messageArea.style.display = 'none'
        }
      }

      document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('mario-json').textContent = JSON.stringify(
          examples.mario.pxon,
          null,
          2
        )
        document.getElementById('mushroom-json').textContent = JSON.stringify(
          examples.mushroom.pxon,
          null,
          2
        )

        renderExample('mario')
        renderExample('mushroom')
      })

      function renderExample(exampleId) {
        const pxonData = examples[exampleId].pxon
        renderPixelGrid(pxonData, `${exampleId}-grid`)
      }
      window.renderExample = renderExample

      function renderCustom() {
        const customInputArea = document.getElementById('custom-input')
        const messageAreaId = 'custom-message-area'
        const gridId = 'custom-grid'

        clearMessage(messageAreaId)
        document.getElementById(gridId).innerHTML = ''

        try {
          let rawInput = customInputArea.value
          if (!rawInput.trim()) {
            showMessage(messageAreaId, 'Please enter some PXON JSON data.', 'error')
            return
          }

          let cleanedInput = rawInput.replace(/\/\/.*/g, '')
          cleanedInput = cleanedInput.replace(/\/\*[\s\S]*?\*\//g, '')
          cleanedInput = cleanedInput.replace(/,\s*\]/g, ']')
          cleanedInput = cleanedInput.replace(/,\s*\}/g, '}')

          const pxonData = JSON.parse(cleanedInput)

          if (
            !pxonData ||
            typeof pxonData.width !== 'number' ||
            typeof pxonData.height !== 'number' ||
            !Array.isArray(pxonData.pixels) ||
            typeof pxonData.colors !== 'object' ||
            pxonData.colors === null
          ) {
            showMessage(
              messageAreaId,
              'Invalid PXON: missing width, height, pixels, or colors.',
              'error'
            )
            return
          }

          renderPixelGrid(pxonData, gridId)
          showMessage(messageAreaId, 'Visualization updated!', 'success')
        } catch (error) {
          console.error('Error parsing custom PXON:', error)
          showMessage(
            messageAreaId,
            'Invalid JSON: ' + error.message,
            'error'
          )
        }
      }
      window.renderCustom = renderCustom

      function renderPixelGrid(pxonData, targetId) {
        const gridElement = document.getElementById(targetId)
        gridElement.innerHTML = ''

        const width = pxonData.width
        const height = pxonData.height
        const pixelSize = 16

        gridElement.style.width = width * pixelSize + 'px'
        gridElement.style.height = height * pixelSize + 'px'

        const gridData = Array(height)
          .fill(null)
          .map(() => Array(width).fill(null))

        if (Array.isArray(pxonData.pixels)) {
          pxonData.pixels.forEach(pixel => {
            if (
              pixel &&
              typeof pixel.x === 'number' &&
              typeof pixel.y === 'number' &&
              pixel.x >= 0 &&
              pixel.x < width &&
              pixel.y >= 0 &&
              pixel.y < height
            ) {
              gridData[pixel.y][pixel.x] = pixel.color
            }
          })
        }

        for (let y = 0; y < height; y++) {
          for (let x = 0; x < width; x++) {
            const pixelElement = document.createElement('div')
            pixelElement.className = 'pixel'

            const colorKey = gridData[y][x]
            if (
              colorKey &&
              pxonData.colors &&
              typeof pxonData.colors === 'object' &&
              pxonData.colors[colorKey]
            ) {
              pixelElement.style.backgroundColor = pxonData.colors[colorKey]
            } else {
              pixelElement.style.backgroundColor = 'transparent'
            }

            gridElement.appendChild(pixelElement)
          }
        }
      }
    </script>
  </body>
</html>
